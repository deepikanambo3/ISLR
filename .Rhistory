plot(pcr.fit, ncomp=1:7)
set.seed(1)
pls.fit <- plsr(Salary ~ ., data = Hitters, scale = T, validation = "CV", subset = train)
pls.fit
summary(pls.fit)
validationplot(pls.fit)
MSEP(pls.fit)
pls.pred <- predict(pls.fit,newdata = predmat[test,], ncomp = 2)
mean((pls.pred - y[test])^2)
pls.pred <- predict(pls.fit,newdata = predmat[test,], ncomp = 3)
mean((pls.pred - y[test])^2)
mean((pls.pred - y[test])^2)
pls.fit <- plsr(Salary ~ ., data = Hitters, scale= T, ncomp = 2)
summary(pls.fit)
set.seed(1)
pls.fit <- plsr(Salary ~ ., data = Hitters, scale= T, ncomp = 2)
summary(pls.fit)
pls.fit <- plsr(Salary ~ ., data = Hitters, scale= T, ncomp = 3)
summary(pls.fit)
Wage <- ISLR::Wage
hmm <- splines::bs(Wage$age, knots = c(25,40,60))
pairs(hmm)
int <- Wage$age < 25
test <- scale(Wage$age[int])
hmm[int,1]
plot(hmm[int,1],test)
plot(hmm[int,2],test)
plot(scale(hmm[int,2]),test)
cor(scale(hmm[int,2]),test)
test <- scale(Wage$age[int]^3)
cor(scale(hmm[int,3]),test)
knitr::opts_chunk$set(echo = TRUE)
Wage <- ISLR::Wage
fit <- lm(wage ~ poly(age,4), data = Wage)
summary(fit)
plot(fit)
library(ggplot2)
ggplot(daat = Wage, mapping = aes(x = age, y = wage)) + geom_point() + geom_smooth(fit)
ggplot(daat = Wage, mapping = aes(x = age, y = wage)) + geom_point() + geom_smooth(method = "lm", formula = formula(fit))
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point() + geom_smooth(method = "lm", formula = formula(fit))
formula(fit)
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point() + geom_smooth(method = "lm", formula = formula(fit),data = Wage)
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point() + geom_smooth(formula = formula(fit),data = Wage)
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point() + geom_smooth(formula = formula(fit))
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point() + geom_smooth(formula = formula(fit)) + theme_bw()
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point() + geom_smooth(formula = formula(fit)) + theme_bw() + geom_smooth(col = "red")
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point() + geom_smooth(formula = formula(fit)) + theme_bw() + geom_smooth(col = "red",se = F)
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point() + theme_bw() + geom_smooth(col = "red",se = F) + geom_smooth(formula = formula(fit))
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point() + theme_bw()  + geom_smooth(method = c("auto", "lm"),formula = c(formula(fit),wage ~ age), col = c("blue", "red"))
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point() + geom_smooth(formula = formula(fit)) + theme_bw() + stat_smooth(col = "red",se = F, formula = wage ~ age)
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point() + geom_stat(formula = formula(fit)) + theme_bw() + stat_smooth(col = "red",se = F, formula = wage ~ age)
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point() + stat_smooth(formula = formula(fit)) + theme_bw() + stat_smooth(col = "red",se = F, formula = wage ~ age)
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point() + stat_smooth(formula = formula(fit),col = "black") + theme_bw() + stat_smooth(col = "red",se = F, formula = wage ~ age)
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point() + stat_smooth(formula = formula(fit),col = "black") + theme_bw() + stat_smooth(col = "red",se = F, formula = wage ~ age, method = "lm")
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point() + stat_smooth(formula = formula(fit),col = "black") + theme_bw() + stat_smooth(col = "red",se = F, formula = wage ~ age, method = "lm", data = Wage)
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point() + stat_smooth(formula = formula(fit),col = "black", method = "lm") + theme_bw() + stat_smooth(col = "red",se = F, formula = wage ~ age, method = "lm", data = Wage)
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point() + stat_smooth(formula = formula(fit),col = "black") + theme_bw() + stat_smooth(col = "red",se = F, formula = wage ~ age, data = Wage)
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point() + stat_smooth(formula = formula(fit),col = "black") + theme_bw(
)
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point() + stat_smooth(formula = formula(fit),col = "black") + theme_bw() + stat_smooth(col = "red",se = F, formula = wage ~ age)
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point() + stat_smooth(formula = formula(fit),col = "black") + theme_bw() + stat_smooth(col = "red",se = F, formula = wage ~ age)
fit <- lm(wage ~ poly(age,4,raw = T), data = Wage)
summary(fit)
fit <- lm(wage ~ poly(age,4,raw = T), data = Wage)
summary(fit)
fit <- lm(wage ~ age + I(age^2) + I(age^3) + I(age^4), data = Wage)
summary(fit)
fit <- lm(wage ~ poly(age,4,raw = T), data = Wage)
summary(fit)
fit.a <- lm(wage ~ age + I(age^2) + I(age^3) + I(age^4), data = Wage)
summary(fit.a)
fit.b <- lm(wage ~ cbind(age,abge^2,age^3,age^4), data = Wage)
fit <- lm(wage ~ poly(age,4,raw = T), data = Wage)
summary(fit)
fit.a <- lm(wage ~ age + I(age^2) + I(age^3) + I(age^4), data = Wage)
summary(fit.a)
fit.b <- lm(wage ~ cbind(age,abe^2,age^3,age^4), data = Wage)
fit <- lm(wage ~ poly(age,4,raw = T), data = Wage)
summary(fit)
fit.a <- lm(wage ~ age + I(age^2) + I(age^3) + I(age^4), data = Wage)
summary(fit.a)
fit.b <- lm(wage ~ cbind(age,age^2,age^3,age^4), data = Wage)
summary(fit.b)
agelims <- range(Wage$age)
agelims
age.grid <- seq(agelims[1],agelims[2])
plot(age.grid)
preds = predict(fit,newdata = age.grid,se.fit = T)
preds = predict(fit,newdata = as.matrix(age.grid),se.fit = T)
preds = predict(fit,newdata = as.data.frame(age.grid),se.fit = T)
as.data.frame(age.grid)
as.data.frame(age = age.grid)
preds = predict(fit,newdata = list(age = age.grid),se.fit = T)
plot(preds$fit)
se.bands <- cbind(preds$fit - 2*preds$se.fit, preds$fit + 2*preds$se.fit)
plot(Wage$age, Wage$wage,xlim = agelims)
plot(Wage$age, Wage$wage,xlim = agelims,cex = 0.5)
plot(Wage$age, Wage$wage,xlim = agelims,cex = 0.5, col = "darkgrey")
plot(Wage$age, Wage$wage,xlim = agelims,cex = 0.5, col = "darkgrey")
lines(age.grid,preds$fit,lwd =2 , col = "blue")
plot(Wage$age, Wage$wage,xlim = agelims,cex = 0.5, col = "darkgrey")
lines(age.grid,preds$fit,lwd =2 , col = "blue")
matlines(age.grid,se.bands,lwd = 1, col = "blue", lty = 3)
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
Wage <- ISLR::Wage
fit <- lm(wage ~ poly(age,4), data = Wage)
summary(fit)
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point() + stat_smooth(formula = formula(fit),col = "black") + theme_bw() + stat_smooth(col = "red",se = F, formula = wage ~ age)
fit2 <- lm(wage ~ poly(age,4,raw = T), data = Wage)
summary(fit)
fit2.a <- lm(wage ~ age + I(age^2) + I(age^3) + I(age^4), data = Wage)
summary(fit.a)
fit2.b <- lm(wage ~ cbind(age,age^2,age^3,age^4), data = Wage)
summary(fit.b)
agelims <- range(Wage$age)
age.grid <- seq(agelims[1],agelims[2])
preds <- predict(fit,newdata = list(age = age.grid),se.fit = T)
se.bands <- cbind(preds$fit - 2*preds$se.fit, preds$fit + 2*preds$se.fit)
plot(Wage$age, Wage$wage,xlim = agelims,cex = 0.5, col = "darkgrey")
lines(age.grid,preds$fit,lwd =2 , col = "blue")
matlines(age.grid,se.bands,lwd = 1, col = "blue", lty = 3)
preds2 <- predict(fit2,newdata = list(age = age.grid),se.fit = T)
preds2 <- predict(fit2,newdata = list(age = age.grid),se.fit = T)
preds2 <- predict(fit2,newdata = list(age = age.grid),se.fit = T)
max(abs(preds$fit - preds2$fit))
plot(preds$fit, preds2$fit)
cor(preds$fit, preds2$fit)
lmfit <- function(data,response,predictor,poly){
library(dplyr)
text = paste0("lm(",response,"~",predictor,"poly(",predictor,",",poly,"),data = data)")
eval(parse(text = text))
}
lmfit(Wage,wage,age,1)
lmfit <- function(data,response,predictor,poly){
library(dplyr)
text = paste0("lm(",response,"~",predictor,"poly(",predictor,",",poly,"),data = data)")
browser()
eval(parse(text = text))
}
lmfit(Wage,wage,age,1)
lmfit(Wage,"wage","age",1)
text
text = paste0("lm(",response,"~","poly(",predictor,",",poly,"),data = data)")
lmfit <- function(data,response,predictor,poly){
library(dplyr)
text = paste0("lm(",response,"~","poly(",predictor,",",poly,"),data = data)")
browser()
eval(parse(text = text))
}
lmfit(Wage,"wage","age",1)
text
eval(parse(text = text))
text = paste0("lm(",response,"~","poly(",predictor,",",poly,"),data = data)")
lmfit <- function(data,response,predictor,poly){
library(dplyr)
text = paste0("lm(",response,"~","poly(",predictor,",",poly,"),data = data)")
eval(parse(text = text))
}
lmfit(Wage,"wage","age",1)
purrr::pmap(.l = list(data = Wage,response = "wage", predictor = "age", poly = seq(1:5)),.f = lmfit)
purrr::pmap(.l = list(data = list(Wage),response = "wage", predictor = "age", poly = seq(1:5)),.f = lmfit)
fits <- purrr::pmap(.l = list(data = list(Wage),response = "wage", predictor = "age", poly = seq(1:5)),.f = lmfit)
fits[[1]]
summary(fits[[1]])
anova(unlist(fits))
unlist(fits)
anova(fits[[1]], fits[[2]], fits[[3]], fits[[4]], fits[[5]])
anova(fits)
as_tibble(fits)
fit[[5]]
fits[[5]]
summary(fits[[5]])
fit.1 <- lm(wage ~ education + age, data = Wage)
fit.2 <- lm(wage ~ education + poly(age,2), data = Wage)
fit.3 <- lm(wage ~ education + poly(age,2), data = Wage)
anova(fit.1,fit.2,fit.3)
fit.1 <- lm(wage ~ education + age, data = Wage)
fit.2 <- lm(wage ~ education + poly(age,2), data = Wage)
fit.3 <- lm(wage ~ education + poly(age,3), data = Wage)
anova(fit.1,fit.2,fit.3)
fit.logistic <- glm(I(wage > 250) ~ poly(age,4), data = Wage,family = "binomial")
summary(fit.logistic)
preds.logistic <- predict(fit.logistic,newdata = list(age = age.grid), se = T)
plot(preds.logistic$fit,Wage$age)
fit.logistic <- glm(I(wage > 250) ~ poly(age,4), data = Wage,family = "binomial")
summary(fit.logistic)
preds.logistic <- predict(fit.logistic,newdata = list(age = age.grid), se = T)
plot(preds.logistic$fit,Wage$age)
plot(preds.logistic$fit,age.grid)
plot(exp(preds.logistic$fit),age.grid)
preds.logistic2 <- predict(fit.logistic,newdata = list(age = age.grid), se = T,response = T)
preds.logistic2 <- predict(fit.logistic,newdata = list(age = age.grid), se = T,response = T)
plot(preds.logistic2$fit,age.grid)
fit.logistic <- glm(I(wage > 250) ~ poly(age,4), data = Wage,family = "binomial")
summary(fit.logistic)
preds.logistic <- predict(fit.logistic,newdata = list(age = age.grid), se = T)
plot(exp(preds.logistic$fit),age.grid)
preds.logistic2 <- predict(fit.logistic,newdata = list(age = age.grid), se = T,type = "response")
plot(preds.logistic2$fit,age.grid)
plot(Wage$age,I(Wage$wage > 250), xlim = agelims, type = "n", ylim = c(0.0.2))
plot(Wage$age,I(Wage$wage > 250), xlim = agelims, type = "n", ylim = c(0,0.2))
cut(Wage$age,4)
table(cut(Wage$age,4))
step.fit <- lm(wage ~ cut(age,4), data = Wage)
step.fit <- lm(wage ~ cut(age,4), data = Wage)
plot(step.fit$fitted.values,Wage$age)
plot(step.fit$fitted.values~Wage$age)
fit.spl <- lm(wage ~ bs(age,knots = c(25,40,60)), data= Wage)
library(splines)
fit.spl <- lm(wage ~ bs(age,knots = c(25,40,60)), data= Wage)
summary(fit.spl)
pred.spl <- predict(fit.spl,newdata = list(age = age.grid), se = T)
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point(col = "grey") + geom_smooth(formula = formula(pred.spl))
formula(pred.spl)
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point(col = "grey") + geom_smooth(formula = formula(fit.spl))
library(splines)
fit.spl <- lm(wage ~ bs(age,knots = c(25,40,60)), data= Wage)
summary(fit.spl)
pred.spl <- predict(fit.spl,newdata = list(age = age.grid), se = T)
plot(Wage$wage ~ Wage$age, col = "gray")
lines(age.grid,pred.spl$fit,lwd = 2)
lines(age.grid,pred.spl$fit + pred.spl$se.fit*2, lty = "dashed")
lines(age.grid,pred.spl$fit - pred.spl$se.fit*2, lty = "dashed")
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point(col = "grey") + geom_smooth(formula = formula(fit.spl))
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point(col = "grey") + geom_smooth(formula = formula(fit.spl)) + theme_classic()
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point(col = "grey") + geom_smooth(formula = formula(fit.spl),method = "lm") + theme_classic()
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point(col = "grey") + geom_smooth(formula = formula(fit.spl),method = "glm") + theme_classic()
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point(col = "grey") + geom_smooth(formula = formula(fit.spl),method = "lm", data = Wage) + theme_classic()
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point(col = "grey") + geom_smooth(formula = formula(fit.spl),method = "gam", data = Wage) + theme_classic()
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point(col = "grey") + geom_smooth(formula = formula(fit.spl)) + theme_classic()
library(splines)
fit.spl <- lm(wage ~ bs(age,knots = c(25,40,60)), data= Wage)
summary(fit.spl)
pred.spl <- predict(fit.spl,newdata = list(age = age.grid), se = T)
plot(Wage$wage ~ Wage$age, col = "gray")
lines(age.grid,pred.spl$fit,lwd = 2)
lines(age.grid,pred.spl$fit + pred.spl$se.fit*2, lty = "dashed")
lines(age.grid,pred.spl$fit - pred.spl$se.fit*2, lty = "dashed")
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point(col = "grey") + geom_smooth(formula = formula(fit.spl)) + theme_classic()
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point(col = "grey") + geom_smooth() + theme_classic()
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point(col = "grey") + geom_smooth(formula = formula(pred.spl)) + theme_classic()
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point(col = "grey") + geom_smooth(formula = formula(fit.spl)) + theme_classic()
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point(col = "grey") + geom_smooth(formula = formula(fit.spl), method = "lm") + theme_classic()
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point(col = "grey") + geom_smooth(formula = formula(fit.spl), method = "lm", data = Wage) + theme_classic()
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point(col = "grey") + stat_smooth(formula = formula(fit.spl), method = "lm", data = Wage) + theme_classic()
ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point(col = "grey") + stat_smooth(formula = formula(fit.spl)) + theme_classic()
dim(bs(Wage$age, knots = c(25,40,60)))
dim(bs(Wage$age,df = 6))
dim(bs(Wage$age,df = 7))
bs(Wage$age,df = 7)$knots
bs(Wage$age,df = 7)
attr(bs(Wage$age,df = 7),"knots")
test <- bs(Wage$age,df = 7)
names(test)
attr(bs(Wage$age,df = 6),"knots")
fit.nspl <- lm(wage ~ ns(age,df = 4), data = Wage)
pred2 <- predict(fit.nspl, newdata = list(age = age.grid), se = T)
lines(age.grid,pred2$fit, col ="red",lwd = 2)
plot(Wage$wage ~ Wage$age, col = "gray")
lines(age.grid,pred.spl$fit,lwd = 2)
lines(age.grid,pred.spl$fit + pred.spl$se.fit*2, lty = "dashed")
lines(age.grid,pred.spl$fit - pred.spl$se.fit*2, lty = "dashed")
lines(age.grid,pred2$fit, col ="red",lwd = 2)
plot(Wage$wage ~ Wage$age, col = "gray")
lines(age.grid,pred.spl$fit,lwd = 2)
lines(age.grid,pred.spl$fit + pred.spl$se.fit*2, lty = "dashed")
lines(age.grid,pred.spl$fit - pred.spl$se.fit*2, lty = "dashed")
lines(age.grid,pred2$fit, col ="red",lwd = 2)
fit.nspl <- lm(wage ~ ns(age,df = 4), data = Wage)
pred2 <- predict(fit.nspl, newdata = list(age = age.grid), se = T)
plot(Wage$wage ~ Wage$age, col = "gray")
lines(age.grid,pred.spl$fit,lwd = 2)
lines(age.grid,pred.spl$fit + pred.spl$se.fit*2, lty = "dashed")
lines(age.grid,pred.spl$fit - pred.spl$se.fit*2, lty = "dashed")
lines(age.grid,pred2$fit, col ="red",lwd = 2)
library(splines)
fit.spl <- lm(wage ~ bs(age,knots = c(25,40,60)), data= Wage)
summary(fit.spl)
pred.spl <- predict(fit.spl,newdata = list(age = age.grid), se = T)
plot(Wage$wage ~ Wage$age, col = "gray")
lines(age.grid,pred.spl$fit,lwd = 2)
lines(age.grid,pred.spl$fit + pred.spl$se.fit*2, lty = "dashed")
lines(age.grid,pred.spl$fit - pred.spl$se.fit*2, lty = "dashed")
# ggplot(data = Wage, mapping = aes(x = age, y = wage)) + geom_point(col = "grey") + stat_smooth(formula = formula(fit.spl)) + theme_classic()
plot(Wage$wage ~ Wage$age, xlim = agelims, cex = 0.5, col = "grey")
fit.smsp <- smooth.spline(Wage$age,Wage$wage, df = 16)
fir.smsp2 <- smooth.spline(Wage$age, Wage$wage,cv = T)
fit.smsp2 <- smooth.spline(Wage$age, Wage$wage,cv = T)
summary(fit.smsp)
summary(fit.smsp2)
fit.smsp2$df
plot(Wage$wage ~ Wage$age, xlim = agelims, cex = 0.5, col = "grey")
fit.smsp <- smooth.spline(Wage$age,Wage$wage, df = 16)
fit.smsp2 <- smooth.spline(Wage$age, Wage$wage,cv = T)
summary(fit.smsp)
fit.smsp2$df
lines(fit.smsp, col = "red", lwd = 2)
lines(fit.smsp2, col = "blue", lwd = 2)
plot(Wage$wage ~ Wage$age, xlim = agelims, cex = 0.5, col = "grey")
fit.smsp <- smooth.spline(Wage$age,Wage$wage, df = 16)
fit.smsp2 <- smooth.spline(Wage$age, Wage$wage,cv = T)
summary(fit.smsp)
fit.smsp2$df
lines(fit.smsp, col = "red", lwd = 2)
lines(fit.smsp2, col = "blue", lwd = 2)
legend("bottom", legend = c("16 DF", "CV DF"), col = c("red", "blue"))
plot(Wage$wage ~ Wage$age, xlim = agelims, cex = 0.5, col = "grey")
fit.smsp <- smooth.spline(Wage$age,Wage$wage, df = 16)
fit.smsp2 <- smooth.spline(Wage$age, Wage$wage,cv = T)
summary(fit.smsp)
fit.smsp2$df
lines(fit.smsp, col = "red", lwd = 2)
lines(fit.smsp2, col = "blue", lwd = 2)
legend("bottom", legend = c("16 DF", "CV DF"), col = c("red", "blue"), outer = T)
legend("bottom", legend = c("16 DF", "CV DF"), col = c("red", "blue"),inset = 1)
plot(Wage$wage ~ Wage$age, xlim = agelims, cex = 0.5, col = "grey")
fit.smsp <- smooth.spline(Wage$age,Wage$wage, df = 16)
fit.smsp2 <- smooth.spline(Wage$age, Wage$wage,cv = T)
summary(fit.smsp)
fit.smsp2$df
lines(fit.smsp, col = "red", lwd = 2)
lines(fit.smsp2, col = "blue", lwd = 2)
legend("bottom", legend = c("16 DF", "CV DF"), col = c("red", "blue"),inset = 1)
plot(Wage$wage ~ Wage$age, xlim = agelims, cex = 0.5, col = "grey")
fit.smsp <- smooth.spline(Wage$age,Wage$wage, df = 16)
fit.smsp2 <- smooth.spline(Wage$age, Wage$wage,cv = T)
summary(fit.smsp)
fit.smsp2$df
lines(fit.smsp, col = "red", lwd = 2)
lines(fit.smsp2, col = "blue", lwd = 2)
legend("bottom", legend = c("16 DF", "CV DF"), col = c("red", "blue"),inset = 0)
plot(Wage$wage ~ Wage$age, xlim = agelims, cex = 0.5, col = "grey")
fit.smsp <- smooth.spline(Wage$age,Wage$wage, df = 16)
fit.smsp2 <- smooth.spline(Wage$age, Wage$wage,cv = T)
summary(fit.smsp)
fit.smsp2$df
lines(fit.smsp, col = "red", lwd = 2)
lines(fit.smsp2, col = "blue", lwd = 2)
legend("topright", legend = c("16 DF", "CV DF"), col = c("red", "blue"),inset = 0)
plot(Wage$wage ~ Wage$age, xlim = agelims, cex = 0.5, col = "grey")
fit.smsp <- smooth.spline(Wage$age,Wage$wage, df = 16)
fit.smsp2 <- smooth.spline(Wage$age, Wage$wage,cv = T)
summary(fit.smsp)
fit.smsp2$df
lines(fit.smsp, col = "red", lwd = 2)
lines(fit.smsp2, col = "blue", lwd = 2)
legend("topright", legend = c("16 DF", "CV DF"), col = c("red", "blue"),lwd = 2,inset = 0)
fit.smsp2$lambda
plot(Wage$wage ~ Wage$age, col = "gray",cex = 0.5)
plot(Wage$wage ~ Wage$age, col = "gray",cex = 0.5)
fit.loess <- loess(wage~age, data = Wage,span = 0.2)
fit.loess.1 <- loess(wage ~ age, data = Wage, s = 0.5)
plot(Wage$wage ~ Wage$age, col = "gray",cex = 0.5)
fit.loess <- loess(wage~age, data = Wage,span = 0.2)
fit.loess.1 <- loess(wage ~ age, data = Wage, span = 0.5)
lines(age.grid,predict(fit.loess,newdata = list(age = age.grid)),col = "red", lwd = 2)
plot(Wage$wage ~ Wage$age, col = "gray",cex = 0.5)
fit.loess <- loess(wage~age, data = Wage,span = 0.2)
fit.loess.1 <- loess(wage ~ age, data = Wage, span = 0.5)
lines(age.grid,predict(fit.loess,newdata = data.frame(age = age.grid)),col = "red", lwd = 2)
lines(age.grid,predict(fit.loess.1,newdata = data.frame(age = age.grid)),col = "blue", lwd = 2)
install.packages("gam")
library(gam)
gam1 <- lm(wage~ns(age,df = 4) + ns(age,5) + education, data = Wage)
gam1 <- lm(wage~ns(year,df = 4) + ns(age,5) + education, data = Wage)
plot(gam1, se = T , col = "red")
plot.gam(gam1, se = T , col = "red")
library(gam)
gam1 <- lm(wage~ns(year,df = 4) + ns(age,5) + education, data = Wage)
plot.gam(gam1, se = T , col = "red")
gam2 <- gam(wage~s(year,4) + s(age,5) + education, data = Wage)
plot(gam2, se = T, col = "red")
gam2 <- gam(wage~s(year,4) + s(age,5) + education, data = Wage)
gam2 <- gam(wage~s(year,4) + s(age,5) + education, data = Wage)
gam2 <- gam(wage~s(year,4) + s(age,5) + education, data = Wage)
plot(gam2, se = T, col = "red")
plot.gam(gam2, se = T, col = "red")
gam2 <- gam(wage~s(year,4) + s(age,5) + education, data = Wage)
gam2
plot(gam2, se = T, col = "red")
gam2 <- gam(wage ~ s(year,4) + s(age,5) + education, data = Wage)
plot(gam2, se = T, col = "red")
plot(gam2, se = TRUE, col = "red")
library(gam)
gam2 <- gam(wage ~ s(year,4) + s(age,5) + education, data = Wage)
plot(gam2, se = TRUE, col = "red")
m
m
library(gam)
gam1 <- lm(wage~ns(year,df = 4) + ns(age,5) + education, data = Wage)
plot.gam(gam1, se = T , col = "red")
gam2 <- gam(wage ~ s(year,4) + s(age,5) + education, data = Wage)
plot(gam2, se = TRUE, col = "red")
plot(gam2)
plot.gam(gam2)
s()
gam2 <- gam(wage ~ S(year,4) + S(age,5) + education, data = Wage)
gam2 <- gam(wage ~ s(year,4) + s(age,5) + education, data = Wage)
plot.gam(gam2)
summary(gam2)
plot(gam2)
gam::plot(gam2)
gam::plot.gam(gam2)
gam2 <- gam(wage ~ s(year,df = 4) + s(age,df = 5) + education, data = Wage)
gam::plot.gam(gam2)
plot(gam2)
GAM_status <- function () {
if (all(c("gam", "mgcv") %in% .packages())) print("Not OK")
else print("OK")
}
GAM_status()
mgcv::plot.gam(gam2)
install.packages("cars")
install.packages("CARS")
install.packages("cars")
install.packages("car")
car::vif(gam1)
car::vif(gam2)
gam.m1 <- gam(wage ~ s(age,5) + education, data = Wage)
gam.m2 <- gam(wage ~ year + s(age,5) + education, data = Wage)
anova(gam.m1,gam,m2,gam2)
anova(gam.m1,gam.m2,gam2)
summary(gam2)
gam::summary(gam2)
anova(gam2)
preds.gam <- predict(gam.m2,newdata = Wage)
gam.lo <- gam(wage ~ s(year,4) + lo(age,span = 0.7) + education, data = Wage)
plot(gam.lo)
remove.packages("mgcv")
plot(gam.lo)
library(gam)
plot(gam.lo)
plot.gam(gam.lo)
install.packages("gam")
install.packages("gam")
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
gam.lo <- gam(wage ~ s(year,4) + lo(age,span = 0.7) + education, data = Wage)
library(gam)
gam.lo <- gam(wage ~ s(year,4) + lo(age,span = 0.7) + education, data = Wage)
plot.gam(gam.lo)
plot.gam(gam.lo,col = "red")
plot.gam(gam.lo,col = "red",se = T)
gam.lo.1 <- gam(wage ~ lo(age,year,span = 0.5) + education, data = Wage)
plot(gam.lo.1)
install.packages("akima")
plot(gam.lo.1)
plot(gam.lo.1, se = T, col = "green")
plot.gam(gam.lo,col = "red",se = T)
gam.lr <- gam(I(wage > 250) ~ year + s(age,df = 5) + education, family = "binomial",data = Wage)
plot(gam.lr)
plot(gam.lr,se= T, col = "green")
table(Wage$education,I(Wage$wage > 256))
levels(Wage$education)
gam.lr <- gam(I(wage > 250) ~ year + s(age,df = 5) + education, family = "binomial",data = Wage, subset = (education != "1. < HS Grad"))
plot(gam.lr,se= T, col = "green")
# For quiz q2
summary(fit.3)
table(cut(Wage$age,4))
# For quiz q3
table(cut(Wage$wage,breaks = c(0,25,40,60,80)))
step.fit.1 <- lm(wage ~ cut(Wage$wage,breaks = c(0,25,40,60,80), data = Wage)
step.fit.1 <- lm(wage ~ cut(Wage$wage,breaks = c(0,25,40,60,80)), data = Wage)
step.fit.1 <- lm(wage ~ cut(Wage$wage,breaks = c(0,25,40,60,80)), data = Wage)
step.fit.1
# For quiz q3
table(cut(Wage$wage,breaks = c(0,25,40,60,80)))
step.fit.1
lot(step.fit.1$fitted.values~Wage$age)
plot(step.fit.1$fitted.values~Wage$age)
plot(step.fit.1$fitted.values~Wage$age)
step.fit.1 <- lm(wage ~ cut(Wage$wage,breaks = c(0,25,40,60,80)), data = Wage)
plot(step.fit.1$fitted.values~Wage$age)
plot(step.fit.1$fitted.values,Wage$wage)
step.fit.1 <- lm(wage ~ cut(Wage$wage,c(0,25,40,60,80)), data = Wage)
plot(step.fit.1$fitted.values,Wage$wage)
step.fit.1 <- lm(wage ~ cut(Wage$wage,c(0,25,40,60,80)), data = Wage)
plot(step.fit.1$fitted.values,Wage$wage)
plot(step.fit.1)
plot(Wages$wage,step.fit.1$fitted.values)
plot(cut(Wage$wage,c(0,25,40,60,80),step.fit.1$fitted.values)
plot(cut(Wage$wage,c(0,25,40,60,80)),step.fit.1$fitted.values)
step.fit.1
plot(step.fit$fitted.values~Wage$age)
step.fit.1 <- lm(wage ~ cut(Wage$age,c(0,25,40,60,80)), data = Wage)
step.fit.1
plot(Wage$age,step.fit.1$fitted.values)
fit.spl <- lm(wage ~ bs(age,knots = c(25,40,60)), data= Wage)
summary(fit.spl)
age.grid
dim(pred.spl)
length(pred.spl)
length(pred.spl$fit)
length(age.grid)
pred.spl <- predict(fit.spl,newdata = list(age = age.grid), se = T)
pred.spl[63]
pred.spl$fit[63]
predict(pred.spl,newdata = data.frame(age = 80))
predict(pred.spl,newdata = data.frame(age = 80))
predict(pred.spl,newdata = list(age = 80))
fit.spl <- lm(wage ~ bs(age,knots = c(25,40,60)), data= Wage)
summary(fit.spl)
predict(pred.spl,newdata = list(age = 80))
predict(pred.spl,data.frame(age = 80))
predict(pred.spl,list(age = 80))
predict(fit.spl,list(age = 80))
pred2$fit[63]
fit.smsp2$y[fit.smsp2$x==80]
predict(fit.loess.1,newdata = data.frame(age = age.grid))[63]
coef(gam.m2)
predict(gam.m2,data.frame(year=2006,age=50,education="3. Some College"))
